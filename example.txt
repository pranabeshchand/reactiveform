import { Validators, FormControl, FormGroup, FormArray, FormBuilder } from '@angular/forms';
import { ToastrService } from 'ngx-toastr';


addReviewForm: FormGroup;

constructor(private toastr: ToastrService, private formbuilder: FormBuilder) {
    this.addReviewForm = this.formbuilder.group({
      name: ['', Validators.required],
      email: ['', [Validators.required, Validators.pattern(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)]],
      comment: ['', Validators.required],
      rating: ['']
    }); 

  }



  addReview() {
    if (this.addReviewForm.invalid) {
      this.isSubmited = true;
      return;
    } else {
      this.emailVerifyStatus = true;
      let emailob: any = { email: this.addReviewForm.value.email }; 
          let data = {
            name: this.addReviewForm.value.name,
            email: this.addReviewForm.value.email,
            comment: this.addReviewForm.value.comment
          } 
        } else {
          console.log("res ", res)
          this.addReviewForm.value.email = "";
          this.toastr.error(res.message);
          this.emailVerifyStatus = false;
        } 

 
  }






  /// Html


  <form [formGroup]="addReviewForm">
            <!-- <div class="stat-con">
                 <span class="rt-mg-bx"><p-rating [cancel]="false" formControlName="rating"></p-rating></span> 
              </div>  -->
            <div class="form-group">
                <textarea class="form-control" formControlName="comment" rows="5"  placeholder="We would love to hear your feedback! "></textarea>
                <p style="color:red; font-size:12px" class="error" *ngIf="addReviewForm.controls['comment'].hasError('required')
                && isSubmited">
                Please add comment.
            </p>
              </div>
          <div class="form-group">
            <input type="text" class="form-control" formControlName="name"  placeholder="Name">
            <p style="color:red; font-size:12px" class="error" *ngIf="addReviewForm.controls['name'].hasError('required')
            && isSubmited">
            Please add your name.
        </p>
          </div>
          <div class="form-group"> 
            <input type="text" class="form-control" formControlName="email" placeholder="Email">
            <p style="color:red; font-size:12px" class="error" *ngIf="addReviewForm.controls['email'].hasError('required')
            && isSubmited">
            Please add your email.
        </p>
        <p style="color:red; font-size:12px" class="error"
        *ngIf="addReviewForm.controls['email'].hasError('pattern')">
        Invalid Email
      </p> 
          </div>
    <!--
          <div class="social-modal"> 
            <div class="custom-check">
                <input type="checkbox" id="gplus" value="1" (change)="setDutyType($event.target.value, $event.target.checked)">
                <label for="gplus">
                  <img src="./assets/images/gplus.png" alt="gplus">    
                </label>
            </div>

            <div class="custom-check">
                <input type="checkbox" id="fplus" value="2" (change)="setDutyType($event.target.value, $event.target.checked)">
                <label for="fplus">
                <img src="./assets/images/fplus.png" alt="fplus">    
                </label>
            </div>

            <div class="custom-check">
                <input type="checkbox" id="cirplus" value="3" (change)="setDutyType($event.target.value, $event.target.checked)">
                <label for="cirplus">
                <img src="./assets/images/cirplus.png" alt="cirplus">    
                </label>
            </div>  
          </div> --> 
          <div class="btn-dv text-center"> 
             <div *ngIf="emailVerifyStatus" class="loader-verify"></div>
              <button type="button" class="btn" (click)="addReview(template3)">NEXT</button>
             
          </div>
          
        </form>